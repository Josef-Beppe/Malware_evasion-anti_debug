## Antivirus evasion
Contains various methods for antivirus (AV) evasion. Executable code can this way be hidden from AVs and live on.\
Uses powershell payload as malicious code. Injecting DLL currently not implemented (said to be detected more easily).\
The main program does nothing itself, only injects. Payload is classic windows calculator. In CreateRemoteThread() notepad is used as target.\
In virustotal.com 8 vendors tagged as malware (when I wrote this). Not the best, but I started with over 25. Clues from the site can be used for further improvements. Windows defender got nothing.

### Usage
- XOR your payload with payload_cryptor by changing the file to be loaded in XORer.py. You can choose different encryption key, again rewrite in XORer.py.

- Copy the payload from payload_XORed.txt to main.cpp, change key if necessary.

- Decide to use either CreateThread() or CreateRemoteThread() and comment the other. They do not work simultaneously.

- If you chose remote thread, you can change target process name, it is a global variable located in the top of main.cpp. Make sure the process is running!

# If you code something new, write it here!!!

### Currently implemented methods
- Payload obfuscation (using XOR)
- python XOR cryptor, made by @cocomelonc
- Sandbox detection (debugger, NUMA, resources)
- Redundant memory allocation
- CreateThread(): in the current process
- CreateRemoteThread(): in another process chosen with name

### Possible improvements
- More methods (dll + others)
- Advanced versions of methods
- Command line interface <- Current focus
- Remake it into a packer

### Resources
Serie about AV evasion with code examples. I only put here 2 articles but more can be found. Great one, helped me the most.:\
https://cocomelonc.github.io/tutorial/2021/09/04/simple-malware-av-evasion.html \
https://cocomelonc.github.io/tutorial/2021/12/25/simple-malware-av-evasion-3.html

Article about payload obfuscation with code:\
https://xen0vas.github.io/antivirus-evasion-kaspersky-endpoint-security-bypass-using-a-fully-undetectable-cryptor/

Article about sandbox detection with code:\
https://www.lastline.com/labsblog/malware-evasion-techniques/

Github repo with payload injection methods:\
https://github.com/Nero22k/Process-Injections-Techniques

Github repos with dll injection methods:\
https://github.com/KooroshRZ/Windows-DLL-Injector \
https://github.com/Dos98/ProcessInjectionTechniques

Note that payload and dll injection uses pretty much the same methods, only the implementation is slightly different. One could be used as a resource for the other.

Github repo for exe packer (packes malware into a new exe with AV evasion):\
https://github.com/KooroshRZ/Evader
